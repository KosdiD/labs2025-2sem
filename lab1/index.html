<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system@4.0.1/dist/aframe-physics-system.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.1.4/dist/aframe/mindar-aframe.prod.js"></script>
    <style>
      body { margin: 0; overflow: hidden; }
      #message { position: absolute; top: 10px; left: 10px; color: white; z-index: 1000; }
    </style>
  </head>
  <body>
    <div id="message">Очікується дозвіл на камеру...</div>

    <a-scene
      mindar-image="imageTargetSrc: ../patterns/rollingstones.patt; autoStart: true"
      embedded
      renderer="colorManagement: true; physicallyCorrectLights: true"
      vr-mode-ui="enabled: false"
      physics="gravity: -9.8"
    >
      <a-assets>
        <img id="hardwood" src="../textures/hardwood.jpg" />
        <img id="disturb" src="../textures/disturb.jpg" />
        <a-asset-item id="font" src="../fonts/volja-regular_w-msdf.json"></a-asset-item>
      </a-assets>

      <a-camera look-controls="enabled: true"></a-camera>

      <a-entity mindar-image-target="targetIndex: 0">
        <a-entity id="scene-root" position="0 0 0">

          <!-- Похила площина -->
          <a-box rotation="-30 0 0" position="0 -0.3 0" width="4" height="0.1" depth="2"
                 material="src: #disturb; repeat: 2 2" static-body></a-box>

          <!-- Циліндр -->
          <a-cylinder radius="0.2" height="0.4" position="-1 0.8 0"
                      rotation="90 0 0" material="src: #hardwood;"
                      dynamic-body="mass: 1; shape: cylinder;"></a-cylinder>

          <!-- Вектори сил -->
          <a-entity geometry="primitive: cone; radiusBottom: 0.02; radiusTop: 0; height: 0.3"
                    material="color: red" position="-1 0.8 0"
                    rotation="-90 0 0"></a-entity>
          <a-text value="mg" font="#font" negate="false" color="red"
                  position="-1 0.5 0.05" width="2"></a-text>

          <a-entity geometry="primitive: cone; radiusBottom: 0.02; radiusTop: 0; height: 0.25"
                    material="color: blue" position="-1 0.8 0"
                    rotation="60 0 0"></a-entity>
          <a-text value="N" font="#font" negate="false" color="blue"
                  position="-0.95 1 0.1" width="2"></a-text>

          <a-entity geometry="primitive: cone; radiusBottom: 0.02; radiusTop: 0; height: 0.2"
                    material="color: green" position="-1 0.8 0"
                    rotation="0 0 90"></a-entity>
          <a-text value="F" font="#font" negate="false" color="green"
                  position="-1.2 0.8 0.1" width="2"></a-text>

          <!-- Світло -->
          <a-entity light="type: directional; color: #ffffff; intensity: 0.9"
                    position="1 2 1"></a-entity>
          <a-entity light="type: ambient; intensity: 0.4"></a-entity>
        </a-entity>
      </a-entity>
    </a-scene>

    <script>
      // Перевірка доступності камери
      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
        document.getElementById("message").innerText =
          "Ваш пристрій не підтримує доступ до камери";
      } else {
        // Спробуємо запитати доступ
        navigator.mediaDevices.getUserMedia({ video: true }).then(function () {
          document.getElementById("message").style.display = "none";
        }).catch(function (err) {
          document.getElementById("message").innerText =
            "Помилка доступу до камери: " + err.name;
        });
      }
    </script>
  </body>
</html>
