<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Rolling Cylinder Physics</title>
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
    <style>
      body { margin: 0; overflow: hidden; }
    </style>
  </head>
  <body>
    <a-scene>
      <!-- Камера з керуванням -->
      <a-entity id="rig" position="0 1.6 5">
        <a-entity camera look-controls wasd-controls></a-entity>
      </a-entity>

      <!-- Освітлення -->
      <a-light type="ambient" intensity="0.5" color="#BBB"></a-light>
      <a-light type="point" position="0 5 0" intensity="2" color="#FFF"></a-light>

      <!-- Площина -->
      <a-box 
        id="plane"
        position="0 0 0"
        rotation="-20 0 0"
        width="4"
        height="0.1"
        depth="6"
        color="#444">
      </a-box>

      <!-- Циліндр -->
      <a-cylinder 
        id="cylinder"
        position="-1.5 1.2 -2"
        rotation="0 0 90"
        radius="0.3"
        height="0.8"
        color="#885533"
        animation="property: position; to: 1.5 -0.5 2; dur: 4000; easing: easeInQuad; loop: true"
        animation__roll="property: rotation; to: 0 0 -630; dur: 4000; easing: linear; loop: true">
      </a-cylinder>

      <!-- Сила тяжіння -->
      <a-entity id="gravity-vector" position="-1.5 2 0">
        <a-cone position="0 -0.4 0" radius-bottom="0.08" radius-top="0" height="0.2" color="purple"></a-cone>
        <a-cylinder position="0 0 0" radius="0.02" height="0.8" color="purple"></a-cylinder>
        <a-text value="mg" position="0.3 0 0" scale="0.5 0.5 0.5" color="purple" align="center"></a-text>
      </a-entity>

      <!-- Нормальна сила -->
      <a-entity id="normal-vector" position="-1.5 2 0" rotation="-20 0 0">
        <a-cone position="0 0.4 0" radius-bottom="0.08" radius-top="0" height="0.2" color="blue"></a-cone>
        <a-cylinder position="0 0 0" radius="0.02" height="0.8" color="blue"></a-cylinder>
        <a-text value="N" position="0.3 0 0" scale="0.5 0.5 0.5" color="blue" align="center"></a-text>
      </a-entity>

      <!-- Сила тертя -->
      <a-entity id="friction-vector" position="-1.5 2 0" rotation="0 0 20">
        <a-cone position="-0.3 0 0" radius-bottom="0.08" radius-top="0" height="0.2" rotation="0 0 -90" color="red"></a-cone>
        <a-cylinder position="0 0 0" radius="0.02" height="0.6" rotation="0 0 90" color="red"></a-cylinder>
        <a-text value="f" position="0 0.3 0" scale="0.5 0.5 0.5" color="red" align="center"></a-text>
      </a-entity>

      <!-- Назва -->
      <a-text 
        value="Rolling Cylinder Physics"
        position="0 2.5 -2"
        scale="1 1 1"
        align="center"
        color="white">
      </a-text>
    </a-scene>

    <script>
      AFRAME.registerComponent('sync-vectors', {
        tick: function () {
          const cylinder = document.querySelector('#cylinder');
          if (cylinder) {
            const pos = cylinder.getAttribute('position');
            document.querySelectorAll('#gravity-vector, #normal-vector, #friction-vector').forEach(vec => {
              if (vec) {
                vec.setAttribute('position', { x: pos.x, y: pos.y + 0.8, z: pos.z });
              }
            });
          }
        }
      });

      document.querySelector('a-scene').setAttribute('sync-vectors', '');
    </script>
  </body>
</html>
